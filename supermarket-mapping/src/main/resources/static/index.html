<html>
<head>
<title>Home Page</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"></script>
   
   <!-- font icon -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
 	                             
  
<link rel="stylesheet"
          href=
"https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <script src=
"https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js">
  </script>
    <script src=
"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js">
    </script>
     




  
	 <!-- <link rel="stylesheet" href="./CSS/styles.css"> -->
	 
  
</head>
<body onload="product()">
	 
	
	
			<div class="bg-blur">
				<header>	 
					
		<nav id="navbarScroll" class="navbar navbar-expand-lg navbar-dark bg-dark"> 
			 
			<a class="navbar-brand" href="#Home-1">
				<img src="./images/logo.jpg" alt="graphic design logo" class="logo rounded-circle mt-3" width="40px"/>
			</a>
			
			
			<!-- Navigation menu -->
			
			 <button class="navbar-toggler btn-white" type="button" data-bs-toggle="collapse" data-bs-target="#navbarScroll" aria-controls="navbarScroll" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
			</button>
					<!-- Navigation menu End -->
					
					 
					
				
					
			
					   
					
				
			<div class="collapse navbar-collapse" id="navbarScroll">
				<input class="form-control " type="search" placeholder="Search" aria-label="Search">
				<button class="btn btn-outline-warning my-4 my-sm-2" type="submit">Search</button>
				
			<ul class="navbar-nav  d-flex">
				
				<li class="nav-item">
					<a class="nav-link t" href="#Home-1" aria-current="page">Home</a>
				</li>
			<li class="nav-item">
					<a class="nav-link " href="#Product-1">Product</a>
				</li>
			<li class="nav-item">
					<a class="nav-link" href="#Category-1">Category</a>
				</li>
			<li class="nav-item">
				<a class="navbar-brand 	" href="#Home.html">
					Hi! <script>document.write(localStorage.getItem('firstName') + ' ' +localStorage.getItem('lastName'));</script> <img src="./images/profile-icon.jpg" alt="graphic design logo" class="logo rounded-circle mt-3" width="40px"/>
				</a>
				
			</li>
			<li class="nav-item">
				<a class="nav-link" href="Login.html">Logout</a>
				
			</li>
					
		</ul>
		
		
		</div>		
			 
			
			</nav>
		</header>	
 

		<!-- Button trigger modal -->
		
	<button type="button" class="btn btn-warning float-right mt-3" data-bs-target="#exampleModal" data-bs-whatever="@fat">
	Add Product</button>

  
  <!-- Modal -->
  
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">

	<div class="modal-dialog">
	  <div class="modal-content">
		<div class="modal-header">
		  <h5 class="modal-title" id="exampleModalLabel">Adding Product</h5>
		  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
		</div>
		<div class="modal-body">

			<div class="container">
				<div class="row d-flex justify-content-center">
				  <div class="col-12">
					<div class="card" style="border-radius: 1rem;">
					  <div class="card-body p-5">
			
				<div class="form-label">
				<label class="form-label" for="product">ProductName</label>
				<input type="text" id="product" class="form-control form-control-lg" />
			   
			 	 </div>

				  <div class="form-label">
					<label class="form-label" for="product">Quantity</label>
					<input type="text" id="stock" class="form-control form-control-lg" />
				   
					  </div>
					  <div class="form-label">
						<label class="form-label" for="product">price</label>
						<input type="text" id="price" class="form-control form-control-lg" />
					   </div>	  
					  <div class="form-label">
						<label class="form-label" for="product">Category Name</label>
						<input type="text" id="category" class="form-control form-control-lg" />
					   
						  </div>	  
						  <p>Choose your product image </p>

						  <div class="form-label">
							<input type="file" id="myFile" name="filename">
							 
						  </div>
					</div>
					</div>
					</div>
					</div>
					</div>
			</div>
		 
		<div class="modal-footer">
		  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
		  <button id="addprod" type="button" class="btn btn-warning">ADD</button>
		</div>
	  </div>
	</div>
  </div>

 
		
		<h1 class=" text-center text-center">Products</h1>
		
  		<div class="container">
		<div class="row" id="myproduct">
			   
			   
				</div>
        </div>


		






 


<script>



 

// // add product with image product

$(document).ready(function(){
        $("#addprod").click(function(){
		var url = "http://localhost:8080/product";

		
		const formData = new FormData();
		var file = $('#myFile').prop("files")[0];

			var productname = $("#product").val();
			var stock = $("#stock").val();
			var category = $("#category").val();
			var price = $("#price").val();
			
  
      formData.append('data', JSON.stringify({
        "productName": productname,
		"stock": stock,
		"categoryId": category,
		"price":price,
		"userId": localStorage.getItem("userId")

	})),
		console.log(formData);
		formData.append('imagefile',file);
 
		$.ajax({
		type: "POST",
		url: url,
		data: formData,
		contentType: false,
    	processData: false,
		 
 		 success: function (requestProduct) {
			 alert("success");
			 
				}
			
			})
 
		})
	
	})

 


function product(){	
	$.ajax({
			dataTypa: "JSON",
			url: "http://localhost:8080/product",
			type:"GET",
			
		success: function (responseText) {
		
					var productData ="";
				
				
			$.each(responseText, function (index, item ) {

					  localStorage.setItem('productId', responseText.productId);
                      localStorage.setItem('productId', responseText.productId);
                      localStorage.setItem('productId', responseText.productId);
                      localStorage.setItem('price', responseText.price);
					
				 

	
			 productData += ' <div class="col-lg-4 "><div class="card mb-3">' ;
				
				 
				   
			$.each(item.data, function (indeximg, itemimg ) {
					
					
					productData += '<img src="data:image/png;base64,'+itemimg.imageData+'" style="width: 350px; height: 300px;/>';
					 
					 
				});
	productData += '<div class="card-body"><h4 class="card-title text-center">' + item.productName +'</h4><p class="card-text text-center">' +"stock: "+item.stock+'</p><p class="card-text text-center">' +"categoryname: "+item.categoryname+'</p><p class="card-text text-center">' +"price: "+item.price+'</p>';
						
						if(localStorage.getItem('userRole') == "Admin"){
						
						productData +='<a onclick="editProduct('+item.productId+')" class="btn btn-warning btn-sm float-right card-link"><strong>Edit</strong></a> <a onclick="deleteProduct('+item.productId+')" class="btn btn-warning btn-sm float-right card-link "><strong>Delete</strong></a>';
						
						}
						else{
							productData +=' <button class="btn btn-outline-warning" type="button" id="Order">Order</button>';
						}
						productData +='</div></div></div> '; 
				
				});
				 	
				$("#myproduct").append(productData);	
			}
			
		});
}

 
	function editProduct(productId){

		var url = "http://localhost:8080/product/"+productId;
		
		$.ajax({
			dataType: "JSON",
			url: url,
			type: "GET",
 
			success: function (response){

				$("#product").val(response.productName);
				$("#stock").val(response.stockDetails);
				$("#category").val(response.categoryname);

				}
		})

		 
	
		$.ajax({
			dataType: "JSON",
			url: url,
			type: "PUT",
			async:false,
			crossDomain:true,
			
		success: function (responseText, status) {

		}
	})
	


}


$(document).ready(function(){
	$("#deletesubmit").click(function(){

	var url = "http://localhost:8080/product";
		var deletedata = null;
	$.ajax({
			dataType: "JSON",
			url: url,
			type: "DELETE",
			async:false,
			crossDomain:true,
			
		success: function (responseText, status) {

		}
	})
	
})
})
 





// $(document).ready (function () {
// 		var url = "http://localhost:8080/items";
// 	$.ajax({
// 			dataTypa: "JSON",
// 			url: url,
// 			type: "POST",
			
// 		success: function (requestProduct) {
					
// 		}

// 	})

// })





// $(document).ready (function () {
// 		var url = "http://localhost:8080/items";
// 	$.ajax({
// 			dataTypa: "JSON",
// 			url: url,
// 			type: "GET",
			
// 		success: function (requestProduct) {
					
// 		}

// 	})

// })




</script>
 
</body>
</html>